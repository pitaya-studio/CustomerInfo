!function(a,b,c){a.projectName="M-tour"}(window,document),function(a,b,c){String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){var b=this.length?this.length:0,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1}),Array.prototype.remove||(Array.prototype.remove=function(a){var b=this.indexOf(a);if(-1===b)return!1;for(var c=0,d=0;c<this.length;c++)this[c]!==this[b]&&(this[d++]=this[c]);return this.length-=1,!0}),Array.prototype.paging||(Array.prototype.paging=function(a,b){return b=+b,b||(b=0),this.slice(a*b,a*(b+1))}),Array.prototype.filter||(Array.prototype.filter=function(a){var b=Object(this),c=b.length?this.length:0;if("function"!=typeof a)throw new TypeError;for(var d=[],e=arguments[1],f=0;c>f;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d})}(window,document);var qc=angular.module("qc",[]);qc.config(["$httpProvider","$provide",function(a,b){b.constant("urlConfig",{mtourApiUrl:window.mtourApiUrl?window.mtourApiUrl:"http://localhost:8080/trekiz_wholesaler_tts/a/mtour/",mtourStaticUrl:window.mtourStaticUrl?window.mtourStaticUrl:"http://localhost:8080/trekiz_wholesaler_tts/static/mtour/static",mtourHtmlTemplateUrl:window.mtourHtmlTemplateUrl?window.mtourHtmlTemplateUrl:"http://localhost:8080/trekiz_wholesaler_tts/static/mtour/html/",mtourLoginUrl:window.mtourLoginUrl?window.mtourLoginUrl:"http://localhost:8080/trekiz_wholesaler_tts/a/login",mtourUploadFileUrl:window.mtourUploadFileUrl?window.mtourUploadFileUrl:"http://localhost:8080//trekiz_wholesaler_tts/a/sys/docinfo/download/",mtourLogoutUrl:window.mtourLogoutUrl?window.mtourLogoutUrl:"http://localhost:8080/trekiz_wholesaler_tts/a/logout",mtourBaseUrl:window.mtourBaseUrl?window.mtourBaseUrl:"http://localhost:8080/trekiz_wholesaler_tts/a/"})}]),qc.constant("qcDateConfig",{changeYear:!0,changeMonth:!0,showMonthAfterYear:!0,dateFormat:"yy-mm-dd"}),qc.directive("qcDate",["qcDateConfig","qcDateConverter",function(a,b){"use strict";var c;return c={},angular.extend(c,a),{require:"?ngModel",link:function(c,d,e,f){var g=function(){return angular.extend({},a,c.$eval(e.qcDate))},h=function(){function a(){var a=["Hours","Minutes","Seconds","Milliseconds"],b=angular.isDate(f.$modelValue),c={};b&&angular.forEach(a,function(a){c[a]=f.$modelValue["get"+a]()}),f.$setViewValue(d.datepicker("getDate")),b&&angular.forEach(a,function(a){f.$viewValue["set"+a](c[a])})}var h=!1,i=g();if(f){var j=i.onSelect||angular.noop;i.onSelect=function(b,e){c.$apply(function(){h=!0,a(),j(b,e),d.blur()})};var k=i.beforeShow||angular.noop;i.beforeShow=function(a,b){h=!0,k(a,b)};var l=i.onClose||angular.noop;i.onClose=function(a,b){h=!1,l(a,b)},d.off("blur.datepicker").on("blur.datepicker",function(){h||c.$apply(function(){d.datepicker("setDate",d.datepicker("getDate")),a()})}),f.$render=function(){var a=f.$modelValue;if(angular.isDefined(a)&&null!==a&&!angular.isDate(a)){if(!angular.isString(f.$modelValue))throw new Error("ng-Model value must be a Date, or a String object with a date formatter - currently it is a "+typeof a+" - use ui-date-format to convert it from a string");a=b.stringToDate(e.qcDateFormat,f.$modelValue)}d.datepicker("setDate",a)}}d.data("datepicker")?(d.datepicker("option",i),d.datepicker("refresh")):(d.datepicker(i),d.on("$destroy",function(){d.datepicker("destroy")})),f&&f.$render()};c.$watch(g,h,!0),d.is("input")&&d.attr("readonly",!0)}}}]),qc.directive("qcDatePeriod",["qcDateConfig","qcDateConverter","$timeout",function(a,b,c){function d(a,b){var c=b.periodText;c||(c="起止日期:");var d='<span class="qc-dateperiod">   <span ng-click="showCalendar()" ng-transclude=""></span>   <div class="qc-dateperiod-container"  ng-show="show">       <div qc-date="dateOptions" ng-model="datePeriod.Sdate" class="qc-dateperiod-calendar" qc-date-format="yy-mm-dd"></div>       <div qc-date="dateOptions" ng-model="datePeriod.Edate" class="qc-dateperiod-calendar" qc-date-format="yy-mm-dd"></div>       <div>           <button class="btn btn-default" ng-click="confirm()">确定</button>       </div>   </div></span>';return d}var e;return e={},angular.extend(e,a),{require:"?ngModel",restrict:"A",replace:!1,transclude:!0,scope:{},template:d,link:function(a,b,d,e){a.showCalendar=function(){a.show=!0,a.datePeriod={}},e.$formatters.push(function(b){a.datePeriod=b}),a.confirm=function(){(a.datePeriod.Sdate||a.datePeriod.Edate)&&c(function(){e.$setViewValue({startDate:a.datePeriod.Sdate,endDate:a.datePeriod.Edate}),a.show=!1,a.$emit(d.ngModel+".change")})},a.$on(d.ngModel+".clear",function(){a.datePeriod={}}),angular.element(document).on("click",function(c){var d=$(c.target);b.has(d).length||d.parents(".ui-datepicker-header").length||(a.show=!1)})}}}]),qc.factory("qcDateConverter",["qcDateFormatConfig",function(a){function b(b,c){if(b=b||a,c){if(b)return jQuery.datepicker.formatDate(b,c);if(c.toISOString)return c.toISOString()}return null}function c(b,c){if(b=b||a,angular.isString(c)){if(b)return jQuery.datepicker.parseDate(b,c);var d=new Date(c);return isNaN(d.getTime())?null:d}return null}return{stringToDate:c,dateToString:b}}]),qc.constant("qcDateFormatConfig",""),qc.directive("qcDateFormat",["qcDateConverter",function(a){var b={require:"ngModel",link:function(b,c,d,e){var f=d.qcDateFormat;e.$formatters.unshift(function(b){return a.stringToDate(f,b)}),e.$parsers.push(function(b){return a.dateToString(f,b)})}};return b}]),function(a,b,c,d){qc.service("ngDragDropService",["$timeout","$parse",function(e,f){this.draggableScope=null,this.droppableScope=null,this.callEventCallback=function(a,b,d,e){function g(b){var d=-1!==b.indexOf("(")?b.indexOf("("):b.length,e=-1!==b.lastIndexOf(")")?b.lastIndexOf(")"):b.length,g=b.substring(d+1,e),h=b.match(/^[^.]+.\s*/)[0].slice(0,-1);return h=a[h]&&"function"==typeof a[h].constructor?h:null,{callback:b.substring(h&&h.length+1||0,d),args:c.map(g&&g.split(",")||[],function(b){return[f(b)(a)]}),constructor:h}}if(b){var h=g(b),i=h.callback,j=h.constructor,k=[d,e].concat(h.args);return(a[i]||a[j][i]).apply(a,k)}},this.invokeDrop=function(a,c,f,g){var h,i,j="",k="",l={},m={},n=null,o={},p={},q=null,r=this.droppableScope,s=this.draggableScope;j=a.ngattr("ng-model"),k=c.ngattr("ng-model"),h=s.$eval(j),i=r.$eval(k),q=c.find("[qc-draggable]:last,[data-qc-draggable]:last"),m=r.$eval(c.attr("qc-droppable")||c.attr("data-qc-droppable"))||[],l=s.$eval(a.attr("qc-draggable")||a.attr("data-qc-draggable"))||[],l.index=this.fixIndex(s,l,h),m.index=this.fixIndex(r,m,i),n=b.isArray(h)?l.index:null,o=b.isArray(h)?h[n]:h,l.deepCopy&&(o=b.copy(o)),p=b.isArray(i)&&m&&m.index!==d?i[m.index]:b.isArray(i)?{}:i,m.deepCopy&&(p=b.copy(p)),l.animate===!0?(this.move(a,q.length>0?q:c,null,"fast",m,null),this.move(q.length>0&&!m.multiple?q:[],a.parent("[qc-droppable],[data-qc-droppable]"),qc.startXY,"fast",m,b.bind(this,function(){e(b.bind(this,function(){a.css({position:"relative",left:"",top:""}),q.css({position:"relative",left:"",top:"",display:"none"===q.css("display")?"":q.css("display")}),this.mutateDraggable(s,m,l,j,k,p,a),this.mutateDroppable(r,m,l,k,o,n),this.callEventCallback(r,m.onDrop,f,g)}))}))):e(b.bind(this,function(){this.mutateDraggable(s,m,l,j,k,p,a),this.mutateDroppable(r,m,l,k,o,n),this.callEventCallback(r,m.onDrop,f,g)}))},this.move=function(b,c,e,f,g,h){if(0===b.length)return h&&a.setTimeout(function(){h()},300),!1;var i=b.css("z-index"),j=b[g.containment||"offset"](),k=c.css("display"),l=c.hasClass("ng-hide");null===e&&c.length>0&&((c.attr("qc-draggable")||c.attr("data-qc-draggable"))!==d&&c.ngattr("ng-model")!==d&&c.is(":visible")&&g&&g.multiple?(e=c[g.containment||"offset"](),g.stack===!1?e.left+=c.outerWidth(!0):e.top+=c.outerHeight(!0)):(l&&c.removeClass("ng-hide"),e=c.css({visibility:"hidden",display:"block"})[g.containment||"offset"](),c.css({visibility:"",display:k}))),b.css({position:"absolute","z-index":9999}).css(j).animate(e,f,function(){l&&c.addClass("ng-hide"),b.css("z-index",i),h&&h()})},this.mutateDroppable=function(a,c,d,e,g,h){var i=a.$eval(e);a.dndDragItem=g,b.isArray(i)?(c&&c.index>=0?i[c.index]=g:i.push(g),d&&d.placeholder===!0&&(i[i.length-1].qc_pos=h)):(f(e+" = dndDragItem")(a),d&&d.placeholder===!0&&(i.qc_pos=h))},this.mutateDraggable=function(a,c,e,g,h,i,j){var k=b.equals(i,{})||!i,l=a.$eval(g);a.dndDropItem=i,e&&e.placeholder?"keep"!==e.placeholder&&(b.isArray(l)&&e.index!==d?l[e.index]=i:f(g+" = dndDropItem")(a)):b.isArray(l)?k?e&&e.placeholder!==!0&&"keep"!==e.placeholder&&l.splice(e.index,1):l[e.index]=i:(f(g+" = dndDropItem")(a),a.$parent&&f(g+" = dndDropItem")(a.$parent)),j.css({"z-index":"",left:"",top:""})},this.fixIndex=function(a,c,d){if(c.applyFilter&&b.isArray(d)&&d.length>0){var e,f=a[c.applyFilter](),g=f[c.index];return d.forEach(function(a,c){b.equals(a,g)&&(e=c)}),e}return c.index}}]).directive("qcDraggable",["ngDragDropService",function(a){return{require:"?qcDroppable",restrict:"A",link:function(c,d,e){var f,g,h,i=function(i,j){i?(f=c.$eval(d.attr("qc-draggable")||d.attr("data-qc-draggable"))||{},g=c.$eval(e.qcOptions)||{},d.draggable({disabled:!1}).draggable(g).draggable({start:function(d,e){a.draggableScope=c,h=b.element(g.helper?e.helper:this).css("z-index"),b.element(g.helper?e.helper:this).css("z-index",9999),qc.startXY=b.element(this)[f.containment||"offset"](),a.callEventCallback(c,f.onStart,d,e)},stop:function(d,e){b.element(g.helper?e.helper:this).css("z-index",h),a.callEventCallback(c,f.onStop,d,e)},drag:function(b,d){a.callEventCallback(c,f.onDrag,b,d)}})):d.draggable({disabled:!0})};c.$watch(function(){return c.$eval(e.drag)},i),i(),d.on("$destroy",function(){d.draggable({disabled:!0}).draggable("destroy")})}}}]).directive("qcDroppable",["ngDragDropService","$q",function(a,c){return{restrict:"A",priority:1,link:function(d,e,f){var g,h=function(h,i){h?(g=d.$eval(b.element(e).attr("qc-droppable")||b.element(e).attr("data-qc-droppable"))||{},e.droppable({disabled:!1}).droppable(d.$eval(f.qcOptions)||{}).droppable({over:function(b,c){a.callEventCallback(d,g.onOver,b,c)},out:function(b,c){a.callEventCallback(d,g.onOut,b,c)},drop:function(e,h){var i=null;i=g.beforeDrop?a.callEventCallback(d,g.beforeDrop,e,h):function(){var a=c.defer();return a.resolve(),a.promise}(),i.then(b.bind(this,function(){b.element(h.draggable).ngattr("ng-model")&&f.ngModel?(a.droppableScope=d,a.invokeDrop(b.element(h.draggable),b.element(this),e,h)):a.callEventCallback(d,g.onDrop,e,h)}),function(){h.draggable.css({left:"",top:""})})}})):e.droppable({disabled:!0})};d.$watch(function(){return d.$eval(f.drop)},h),h(),e.on("$destroy",function(){e.droppable({disabled:!0}).droppable("destroy")})}}}]),b.element.prototype.ngattr=function(a,c){var d=b.element(this).get(0);return d.getAttribute(a)||d.getAttribute("data-"+a)}}(window,window.angular,window.jQuery),qc.directive("qcDropdown",function(){return{require:"^ngModel",restrict:"AE",scope:{filterExpression:"@",items:"=",multiple:"@",listWidth:"=",listMaxHeight:"="},replace:!0,template:function(a,b){var c=[];c.push('<div class="qc-dropdown">');var d='<div class="qc-dropdown-text-container" ng-click="showList()">',e="请选择";b.dropdownText&&(e=b.dropdownText),d+='<span  class="qc-dropdown-text" title="'+e+'">'+e+"</span>",d+='<span class="qc-dropdown-anchor">▼</span>',d+="</div>",c.push(d),c.push('<div class="qc-dropdown-container" ng-if="active"   ng-style="{\'width\':listWidth}">'),b.listMaxHeight?c.push('<ul class="qc-dropdown-list qc-scroll" ng-style="{\'max-height\':listMaxHeight}">'):c.push('<ul class="qc-dropdown-list" ng-style="{\'max-height\':listMaxHeight}">'),c.push('<li class="qc-dropdown-list-search" ng-hide="!filterExpression"><div  class="qc-dropdown-filter-container"><input class="qc-dropdown-filter" ng-model="filterText" ></div><em></em></li>');var f="";b.filterExpression&&(f=" | qcPropsFilter:'"+b.filterExpression+"':filterText");var g="(qcDropdownItem==selectedItem)";return"multiple"===b.multiple&&(g="(selectedItem.indexOf(qcDropdownItem)>-1)"),c.push('<li class="qc-dropdown-item" ng-class="{active:'+g+'}" ng-click="select(qcDropdownItem)" ng-repeat="qcDropdownItem in items'+f+'">'+b.itemText+"</li>"),c.push("</ul>"),c.push("</div>"),c.push("</div>"),c.join("")},link:function(a,b,c,d){d.$formatters.push(function(b){a.selectedItem=b}),d.$parsers.unshift(function(b){return"multiple"!==a.multiple?(a.active=!1,a.selectedItem=b,a.clearFilter(),b):(-1===d.$modelValue.indexOf(b)?d.$modelValue.push(b):d.$modelValue.remove(b),d.$modelValue)}),a.showList=function(){a.active=!0,setTimeout(function(){b.find(".qc-dropdown-filter").focus()},100)},a.select=function(b){d.$setViewValue(b),a.$emit(c.ngModel+".change")},a.clearFilter=function(){a.filterText=""},angular.element(document).on("click",function(c){var d=$(c.target);b.has(d).length||a.$apply(function(){a.active=!1,a.clearFilter()})})}}}),qc.directive("qcDropdownAsync",function(){return{require:"^ngModel",restrict:"AE",scope:{filterExpression:"@",items:"=",listWidth:"=",multiple:"@",idName:"@",modelName:"@",listMaxHeight:"="},replace:!0,template:function(a,b){var c=[];c.push('<div class="qc-dropdown">');var d='<div class="qc-dropdown-text-container" ng-click="showList()">',e="请选择";return b.dropdownText&&(e=b.dropdownText),d+='<span  class="qc-dropdown-text" title="'+e+'">'+e+"</span>",d+='<span class="qc-dropdown-anchor">▼</span>',d+="</div>",c.push(d),c.push('<div class="qc-dropdown-container" ng-if="active"   ng-style="{\'width\':listWidth}">'),b.listMaxHeight?c.push('<ul class="qc-dropdown-list qc-scroll" ng-style="{\'max-height\':listMaxHeight}">'):c.push('<ul class="qc-dropdown-list" ng-style="{\'max-height\':listMaxHeight}">'),c.push('<li class="qc-dropdown-list-search"  ng-hide="!filterExpression"><div  class="qc-dropdown-filter-container"><input class="qc-dropdown-filter"  ng-keyup="search()" ></div><em></em></li>'),c.push('<li class="qc-dropdown-item"ng-click="select(qcDropdownItem)" ng-repeat="qcDropdownItem in items" ng-class="{\'active\':getItemInNgModel(qcDropdownItem)}">'+b.itemText+"</li>"),c.push("</ul>"),c.push("</div>"),c.push("</div>"),c.join("")},link:function(a,b,c,d){d.$formatters.push(function(b){a.selectedItem=b}),d.$parsers.unshift(function(b){if("multiple"!==a.multiple)return a.active=!1,a.selectedItem=b,a.clearFilter(),b;var c=a.getItemInNgModel(b);return c?d.$modelValue.remove(c):d.$modelValue.push(b),d.$modelValue}),a.getItemInNgModel=function(b){if(!d.$modelValue)return null;if("multiple"!==a.multiple){var c=!1;return c=a.idName?b[a.idName]===d.$modelValue[a.idName]:b===d.$modelValue,c?d.$modelValue:null}return d.$modelValue.filter(function(c){var d=!1;return d=a.idName?b[a.idName]===c[a.idName]:b===c})[0]},a.search=function(){var e=b.find("input");a.multiple&&!d.$modelValue&&(d.$modelValue=[]),a.$emit(c.ngModel+".search",e.val())},a.showList=function(){a.active=!0,setTimeout(function(){b.find(".qc-dropdown-filter").focus(),a.search()},100)},a.select=function(b){a.selectedItem&&b[a.idName]===a.selectedItem[a.idName]||(d.$setViewValue(b),a.$emit(c.ngModel+".change"))},a.clearFilter=function(){a.filterText="",a.item=[]},angular.element(document).on("click",function(c){var d=$(c.target);b.has(d).length||a.$apply(function(){a.active=!1,a.clearFilter()})})}}}),qc.directive("qcInputAmount",["$timeout",function(a){return{require:"^ngModel",restrict:"A",scope:{qcInputNumber:"="},link:function(a,b,c,d){var e={intLength:9,zero:!0,decimalLength:2},f=angular.extend(e,a.qcInputNumber),g=function(a){var b;b=0===f.decimalLength?new RegExp("^\\d{1,"+f.intLength+"}$"):new RegExp("^\\d{1,"+f.intLength+"}(\\.\\d{0,"+f.decimalLength+"}){0,1}$");var c=b.test(a);return c};d.$parsers.push(function(a){if(!a&&0!==a&&"0"!==a)return a;var b=g(a);if(b){if(f.maxValue){var c=parseFloat(a);c>f.maxValue&&(a=f.maxValue)}if(!f.zero){var c=parseFloat(a);0===c&&(a=d.$modelValue)}a&&a.length>1&&"0"===a[0]&&(a=a.substr(1,a.length-1))}else a=d.$modelValue;return d.$viewValue=a,d.$render(),a})}}}]),qc.directive("qcInputInt",["$timeout",function(a){return{require:"^ngModel",restrict:"A",scope:{qcInputInt:"="},link:function(a,b,c,d){var e={intLength:5,decimalLength:0},f=angular.extend(e,a.qcInputInt),g=function(a){var b;b=0===f.decimalLength?new RegExp("^\\d{0,"+f.intLength+"}$"):new RegExp("^\\d{0,"+f.intLength+"}(\\.\\d{0,"+f.decimalLength+"}){0,1}$");var c=b.test(a);return c};d.$parsers.push(function(a){if(!a&&0!==a&&"0"!==a)return a;var b=g(a);if(b){if(f.maxValue){var c=parseInt(a);c>f.maxValue&&(a=f.maxValue)}if(!f.zero){var c=parseInt(a);0===c&&(a=d.$modelValue)}a&&a.length>1&&"0"===a[0]&&(a=a.substr(1,a.length-1))}else a=d.$modelValue;return d.$viewValue=a,d.$render(),a})}}}]),qc.directive("qcInputEnglishName",["$timeout",function(a){return{require:"^ngModel",restrict:"A",link:function(a,b,c,d){var e=function(a){var b;b=new RegExp("^[a-zA-Z.\\-_()]{0,}$");var c=b.test(a);return c};d.$parsers.push(function(a){if(!a)return a;var b=e(a);return b||(a=d.$modelValue),d.$viewValue=a,d.$render(),a})}}}]),qc.directive("qcInputCode",["$timeout",function(a){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){var e=function(a){var b;b=new RegExp("^[a-zA-Z0-9]{0,6}$");var c=b.test(a);return c};d.$parsers.push(function(a){if(!a)return a;var b=e(a);return b||(a=d.$modelValue),d.$viewValue=a,d.$render(),a})}}}]),qc.directive("qcInputHour",["$timeout",function(a){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){var e=function(a){var b;b=new RegExp("^[0-1]{0,1}[0-9]{0,1}$");var c=b.test(a),d=new RegExp("^[2]{0,1}[0-3]{0,1}$"),e=d.test(a);return c||e};d.$parsers.push(function(a){if(!a)return a;var b=e(a);return b||(a=d.$modelValue),d.$viewValue=a,d.$render(),a})}}}]),qc.directive("qcInputMinute",["$timeout",function(a){return{require:"?ngModel",restrict:"A",link:function(a,b,c,d){var e=function(a){var b;b=new RegExp("^([0-5]{0,1}[0-9]{0,1})$");var c=b.test(a);return c};d.$parsers.push(function(a){if(!a)return a;var b=e(a);return b||(a=d.$modelValue),d.$viewValue=a,d.$render(),a})}}}]),qc.directive("input",["$timeout",function(a){return{require:"?ngModel",restrict:"E",link:function(a,b,c,d){var e=50;d&&d.$parsers.push(function(a){return a?(a.length>e&&(a=a.substr(0,e),d.$viewValue=a,d.$render()),a):a})}}}]),function(a){a.extend(a,{placeholder:{browser_supported:function(){return void 0!==this._supported?this._supported:this._supported=!!("placeholder"in a('<input type="text">')[0])},shim:function(b){var c={color:"#888",cls:"placeholder",selector:"input[placeholder], textarea[placeholder]",align:"left"};a.extend(c,b),this.browser_supported()||a(c.selector)._placeholder_shim(c)}}}),a.extend(a.fn,{_placeholder_shim:function(b){function c(b){var c=a(b).offsetParent().offset(),d=a(b).offset();return{top:d.top-c.top,left:d.left-c.left,width:a(b).outerWidth(!0)}}return this.each(function(){var d=a(this);if(d.data("placeholder")){var e=d.data("placeholder");return e.css(c(d)),!0}var f={};d.is("textarea")||"auto"===d.css("line-height")||(f={lineHeight:d.css("line-height"),whiteSpace:"nowrap"});var g=a("<label />").text(d.attr("placeholder")).addClass(b.cls).css(a.extend({position:"absolute",display:"inline","float":"none",overflow:"hidden",textAlign:b.align,color:b.color,cursor:"text",paddingTop:d.css("padding-top"),paddingRight:d.css("padding-right"),paddingBottom:d.css("padding-bottom"),paddingLeft:d.css("padding-left"),fontSize:d.css("font-size"),fontFamily:d.css("font-family"),fontStyle:d.css("font-style"),fontWeight:d.css("font-weight"),textTransform:d.css("text-transform"),backgroundColor:"transparent",zIndex:99},f)).css(c(this)).attr("for",this.id).data("target",d).click(function(){a(this).data("target").focus()}).insertBefore(this);d.data("placeholder",g).focus(function(){g.hide()}).blur(function(){g[d.val().length?"hide":"show"]()}).triggerHandler("blur"),a(window).resize(function(){var a=g.data("target");g.css(c(a))})})}})}(jQuery),qc.directive("placeholder",["$interpolate","$timeout",function(a,b){return jQuery.placeholder.browser_supported()?{}:function(c,d,e){function f(){k=b(function(){d._placeholder_shim(g),j=d.data("placeholder"),k=null})}var g={color:"#888",cls:"placeholder"},h=a(d.attr("placeholder")),i=null,j=null,k=null;b(function(){d.is(":visible")&&f()},100),c.$watch(function(){if(j||!d.is(":visible")||k||f(),j&&d.get(0)!==document.activeElement&&(d.val().length?j.hide():j.show()),j){var a=h(c);a!==i&&(i=a,j.text(i))}}),c.$on("$destroy",function(){k&&(b.cancel(k),k=null)})}}]),qc.directive("qcScroll",["$timeout",function(a){return{restrict:"C",scope:{qcScrollOptions:"="},link:function(b,c,d){var e={zindex:"auto",cursoropacitymin:0,cursoropacitymax:1,cursorcolor:"",cursorwidth:"8px",cursorborder:"",cursorborderradius:"",scrollspeed:60,mousescrollstep:24,touchbehavior:!1,hwacceleration:!0,usetransition:!0,boxzoom:!1,dblclickzoom:!0,gesturezoom:!0,grabcursorenabled:!0,autohidemode:"leave",background:"",iframeautoresize:!0,cursorminheight:32,preservenativescrolling:!0,railoffset:!1,railhoffset:!1,bouncescroll:!0,spacebarenabled:!0,railpadding:{top:0,right:0,left:0,bottom:0},disableoutline:!0,horizrailenabled:!0,railalign:"right",railvalign:"bottom",enabletranslate3d:!0,enablemousewheel:!0,enablekeyboard:!0,smoothscroll:!0,sensitiverail:!0,enablemouselockapi:!0,cursorfixedheight:!1,directionlockdeadzone:6,hidecursordelay:0,nativeparentscrolling:!0,enablescrollonselection:!0,overflowx:!0,overflowy:!0,cursordragspeed:.3,rtlmode:"auto",cursordragontouch:!1,oneaxismousemode:"auto",preventmultitouchscrolling:!0,createDelay:400},f=angular.extend(e,b.qcScrollOptions);a(function(){c.niceScroll(f)},f.createDelay),b.$on("qcTableContainer.reset",function(){a(function(){c.getNiceScroll().resize()},500)})}}}]),qc.directive("qcSubTableParent",function(){return{restrict:"A",scope:!1,link:function(a,b,c){angular.isArray(a.qcSubTableIds)&&(a.spreadCount=0,angular.forEach(a.qcSubTableIds,function(b){a.$on("subTable.spread.ready."+b,function(){a.spreadCount++}),a.$on("subTable.fold.ready."+b,function(){a.spreadCount&&a.spreadCount--}),a.$on("subTable.spreadAll",function(){a.spreadCount++}),a.$on("subTable.foldAll",function(){a.spreadCount&&a.spreadCount--})}))}}}),qc.directive("qcSubTable",["$timeout",function(a){return{restrict:"A",template:'<div ng-if="spreaded" ng-transclude=""></div>',transclude:!0,scope:{qcSubTableId:"@",manualReady:"="},link:function(b,c,d){b.spreaded=!1,c.css("display","none"),b.show=function(){b.spreaded=!0,a(function(){c.parents("tbody:first").show(),c.slideDown(350),b.$emit("subTable.spread.complete",b.qcSubTableId)})},b.hide=function(){c.slideUp(350,function(){c.parents("tbody:first").hide(),b.spreaded=!1,a(function(){b.$emit("subTable.fold.complete",b.qcSubTableId)})})},b.$on("subTable.spread.ready",function(a,c){b.qcSubTableId===c?b.show():b.hide()}),b.$on("subTable.fold",function(){b.hide()})}}}]),qc.directive("qcTab",function(){return{restrict:"AE",controller:function(a){this.showTab=function(b,c){a.activeTab=b,angular.isFunction(a.qcTabChanged)&&b!==c&&a.qcTabChanged(b,c)}},scope:!0,replace:!1,link:function(a,b,c){a.activeTab=c.activeTab,c.qcTabChanged&&(a.qcTabChanged=a.$eval(c.qcTabChanged))}}}),qc.directive("qcTabHeader",function(){return{require:"^qcTab",restrict:"AE",scope:!0,replace:!0,transclude:!0,template:'<div  ng-transclude ng-class="{active:(qcTabName==activeTab)}"></div>',link:function(a,b,c,d){a.qcTabName=c.qcTabName,b.on("click",function(){a.$apply(function(){d.showTab(a.qcTabName,a.activeTab)})})}}}),qc.directive("qcTabBody",function(){return{restrict:"AE",require:"^qcTab",scope:!0,transclude:!0,replace:!0,template:'<div ng-hide="qcTabName!=activeTab" ng-transclude ></div>',link:function(a,b,c,d){a.qcTabName=c.qcTabName}}}),qc.directive("qcTableContainer",["$window","$timeout",function(a,b){return{restrict:"C",link:function(c,d,e){function f(){var b=d.offset().top;d.css({height:$(a).height()-(b+g)})}var g=+e.bottomGap;isNaN(g)&&(g=0),b(function(){f()},1e3),$(a).resize(function(){f()}),c.$on("qcTableContainer.reset",function(){b(function(){f()},1e3)})}}}]),qc.directive("qcTableFixedHeader",["$timeout","$compile",function(a,b){return{restrict:"A",link:function(c,d,e){var f=10,g=d.clone();g.empty(),g.append(d.find("thead").clone()),g.addClass("qc-table-fixed-header"),g.removeAttr("qc-table-fixed-header"),d.after(g),b(g)(c),g.hide();var h,i=d.offsetParent();i.scroll(function(){a.cancel(h);var b=$(this),c=b.find(".qc-table-fixed-header");c.hide(),h=a(function(){var a=d.position().top,e=b.scrollTop();c.css({top:e}),-a>f&&c.fadeIn(100)},200)})}}}]),qc.directive("qcTableOperator",["$timeout",function(a){return{restrict:"C",scope:{qcTableOperatorOption:"="},template:'<div ng-transclude ng-if="active"></div>',replace:!1,transclude:!0,link:function(b,c,d){var e={activeDelay:300,inactiveDelay:295},f=angular.extend(e,b.qcTableOperatorOption);d.height&&c.css("height",d.height+"px"),d.width&&c.css("width",d.width+"px");var g,h,i=c.parents("tbody:first").addClass("qc-table-operator-tbody"),j=c.parents("td:first");i.on("mouseenter",function(){a.cancel(h),g=a(function(){var a=j.offsetParent().scrollTop(),d=j.offsetParent().scrollLeft(),e=j.position().left+d,f=j.position().top+a,g=c.height(),h=c.width();a>f&&(f=a);var i=j.offsetParent().height()+a;f+g>i&&(f=i-g);var k=j.offsetParent().width()+d;e+h>k&&(e=k-h),c.css({top:f,left:e}),c.show(),b.active=!0},f.activeDelay)}),i.on("mouseleave",function(){a.cancel(g),h=a(function(){c.hide(),b.active=!1},f.inactiveDelay)})}}}]),function(a,b){var c,d=function(a,b){return function(){return a.apply(b,arguments)}},e=[].slice;return c=function(){function c(c,e){this.mousedown=d(this.mousedown,this);var f=this;this.options=a.extend({},this.defaults,e),this.$table=c,this.tableId=this.$table.data("resizable-columns-id"),this.createHandles(),this.restoreColumnWidths(),this.syncHandleWidths(),a(b).on("resize.rc",function(){return f.syncHandleWidths()})}return c.prototype.defaults={store:b.store,rigidSizing:!1},c.prototype.destroy=function(){return this.$handleContainer.remove(),this.$table.removeData("resizableColumns"),a(b).off(".rc")},c.prototype.createHandles=function(){var b=this;return this.$table.before(this.$handleContainer=a("<div class='qc-table-resizecolumn-container' />")),this.$table.find("tr th").each(function(c,d){var e;if(0!==b.$table.find("tr th").eq(c).length&&null==b.$table.find("tr th").eq(c).attr("data-noresize")&&null==b.$table.find("tr th").eq(c+1).attr("data-noresize"))return e=a("<div class='qc-table-resizecolumn-handle' />"),e.data("th",a(d)),e.appendTo(b.$handleContainer)}),this.$handleContainer.on("mousedown",".qc-table-resizecolumn-handle",this.mousedown)},c.prototype.syncHandleWidths=function(){var b=this;return this.$handleContainer.width(this.$table.width()),this.$handleContainer.find(".qc-table-resizecolumn-handle").each(function(c,d){return a(d).css({left:a(d).data("th").outerWidth()+a(d).data("th").position().left,height:b.$table.find("thead").height()})})},c.prototype.saveColumnWidths=function(){var c=this;return this.$table.find("tr th").each(function(d,e){var f;return null==a(e).attr("data-noresize")&&(f=c.tableId+"-"+a(e).data("resizable-column-id"),null!=c.options.store)?b.store.set(f,a(e).width()):void 0})},c.prototype.restoreColumnWidths=function(){var c=this;return this.$table.find("tr th").each(function(d,e){var f,g;return f=c.tableId+"-"+a(e).data("resizable-column-id"),null!=c.options.store&&(g=b.store.get(f))?a(e).width(g):void 0})},c.prototype.mousedown=function(b){var c,d,e,f,g,h,i=this;return b.preventDefault(),this.startPosition=b.pageX,c=a(b.currentTarget),d=c.data("th"),g=d.width(),f=this.$table.find("tr th").index(c.data("th")),e=this.$table.find("tr th").eq(f+1),h=e.width(),a(document).on("mousemove.rc",function(a){var b,c,f;if(b=a.pageX-i.startPosition,f=h-b,c=g+b,!(i.options.rigidSizing&&parseInt(e[0].style.width)<e.width()&&f<e.width()||parseInt(d[0].style.width)<d.width()&&c<d.width())){var j=parseInt(d.css("min-width")),k=parseInt(e.css("min-width"));return d.width(c>j?c:j),e.width(f>k?f:k),i.syncHandleWidths()}}),a(document).one("mouseup",function(){return a(document).off("mousemove.rc"),i.saveColumnWidths()})},c}(),a.fn.extend({resizableColumns:function(){var b,d;return d=arguments[0],b=2<=arguments.length?e.call(arguments,1):[],this.each(function(){var e,f;return e=a(this),f=e.data("resizableColumns"),f||e.data("resizableColumns",f=new c(e,d)),"string"==typeof d?f[d].apply(f,b):void 0})}})}(window.jQuery,window),qc.directive("qcTableResizecolumn",function(){return{restrict:"C",link:function(a,b,c){b.resizableColumns({})}}}),qc.directive("passwordValidate",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(b){return a.pwdValidLength=b&&b.length>=8?"valid":void 0,a.pwdHasLetter=b&&/[A-z]/.test(b)?"valid":void 0,a.pwdHasNumber=b&&/\d/.test(b)?"valid":void 0,a.pwdValidLength&&a.pwdHasLetter&&a.pwdHasNumber?(d.$setValidity(c.ngModel,!0),b):void d.$setValidity(c.ngModel,!1)})}}}),qc.directive("validateCode",function(){return{require:"ngModel",controller:function(a){},link:function(a,b,c,d){var e=a.$eval(c.validateCode);angular.isObject(a.validOptions)||(a.validOptions={}),angular.extend(a.validOptions,{validateCode:e}),d.$parsers.push(function(a){var c;c=angular.isObject(e)?e.length:e,c||(c=4);var f=new RegExp("^[a-zA-Z]{"+c+"}$"),g=f.test(a);return d.$setValidity("validateCode",g),g?b.tooltip("destroy"):(b.tooltip({container:"body",html:!0,title:e.msg,trigger:"focus"}),b.tooltip("show")),g?a:void 0})}}}),qc.directive("qcValidRequired",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){return d.$isEmpty(a)?(d.$setValidity("qcValidRequired",!1),!1):(d.$setValidity("qcValidRequired",!0),!0)};d.$parsers.push(function(a){return e(a),a}),b.on("blur click focus",function(){e(d.$modelValue)}),a.$on("qcValid.check",function(){e(d.$modelValue)})}}}),qc.directive("qcValidEmail",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){var b=/^[a-zA-Z0-9_\\.]+@[a-zA-Z0-9-]+[\\.a-zA-Z]+$/,c=b.test(a);return d.$setValidity("qcValidEmail",a?c:!0),c};d.$parsers.push(function(a){return e(a),a}),d.$formatters.push(function(a){return e(a),a})}}}),qc.directive("qcValidNumber",function(){return{require:"ngModel",scope:{qcValidNumber:"="},link:function(a,b,c,d){var e={intLength:20,decimalLength:10},f=angular.extend(e,a.qcValidNumber),g=function(a){var b;b=0===f.decimalLength?new RegExp("^\\d{1,"+f.intLength+"}$"):new RegExp("^\\d{1,"+f.intLength+"}(\\.\\d{1,"+f.decimalLength+"}){0,1}$");var c=b.test(a);return d.$setValidity("qcValidNumber",a?c:!0),c};d.$parsers.push(function(a){return g(a),a}),d.$formatters.push(function(a){return g(a),a})}}}),qc.filter("qcCurrency",["$filter",function(a){return function(b,c){var d=a("currency");return 0>b?d(b,c).replace("(","").replace(")","").replace(c,c+"-"):d(b,c)}}]),qc.filter("qcPaging",function(){return function(a,b,c){return a.paging(b,c-1)}}),qc.filter("qcPropsFilter",function(){return function(a,b,c){if(angular.isUndefined(c))return a;var d=b.split(","),e=d.length;return a.filter(function(a){for(var b=!1,f=0;e>f;f++)if(angular.isString(a[d[f]])&&a[d[f]].indexOf(c)>=0){b=!0;break}return b})}}),qc.provider("qcApi",function(){this.$get=["$http","urlConfig",function(a,b){function c(c,d){var e="requestType=mtour data";d&&(e+="&param="+JSON.stringify(d)),e=encodeURI(e);var f=b.mtourApiUrl+c+"?date="+new Date;return a.post(f,e,{headers:{"Content-Type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"}})}function d(c,d){var e={requestType:"mtour data",param:d},f=b.mtourApiUrl+c+"?date="+new Date;return a.get(f,e,{headers:{"Content-Type":"application/x-www-form-urlencoded","x-requested-with":"XMLHttpRequest"}})}return{get:d,post:c}}]}),qc.service("qcCookie",["$document",function(a){this.get=function(b){if(a[0].cookie&&a[0].cookie.length>0){var c=a[0].cookie.indexOf(b+"=");if(-1!==c){c=c+b.length+1;var d=a[0].cookie.indexOf(";",c);
return-1===d&&(d=a[0].cookie.length),angular.fromJson(a[0].cookie.substring(c,d))}}return""},this.set=function(b,c,d){var e="";if(!angular.isUndefined(d)){var f=new Date;f.setTime(f.getTime()+24*d*60*60*1e3);var e="expires="+f.toUTCString()}e?a[0].cookie=b+"="+angular.toJson(c)+"; "+e+"; path=/":a[0].cookie=b+"="+angular.toJson(c)+"; path=/"},this.remove=function(a){this.set(a,"",-1)}}]),qc.provider("qcDialog",function(){var a=angular.element,b=angular.isDefined,c=(document.body||document.documentElement).style,d=b(c.animation)||b(c.WebkitAnimation)||b(c.MozAnimation)||b(c.MsAnimation)||b(c.OAnimation),e="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",f="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",g="qc-dialog-disabled-animation",h={html:!1,body:!1},i={},j=[],k=!1,l=this.defaults={className:"qc-dialog-theme-default",disableAnimation:!1,draggable:!0,plain:!1,showClose:!0,closeByDocument:!1,closeByEscape:!1,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!1,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null};this.setForceHtmlReload=function(a){h.html=a||!1},this.setForceBodyReload=function(a){h.body=a||!1},this.setDefaults=function(a){angular.extend(l,a)};var m,n=0,o=0,p={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(b,c,q,r,s,t,u,v,w,x){var y=[];angular.forEach(["html","body"],function(a){if(y[a]=b.find(a),h[a]){var c=z.getRouterLocationEventName();t.$on(c,function(){y[a]=b.find(a)})}});var z={onDocumentKeydown:function(a){27===a.keyCode&&A.close("$escape")},activate:function(a){var b=a.data("$qcDialogOptions");b.trapFocus&&(a.on("keydown",z.onTrapFocusKeydown),y.body.on("keydown",z.onTrapFocusKeydown))},deactivate:function(a){a.off("keydown",z.onTrapFocusKeydown),y.body.off("keydown",z.onTrapFocusKeydown)},deactivateAll:function(){angular.forEach(function(a){var b=angular.element(a);z.deactivate(b)})},setBodyPadding:function(a){var b=parseInt(y.body.css("padding-right")||0,10);y.body.css("padding-right",b+a+"px"),y.body.data("ng-dialog-original-padding",b)},resetBodyPadding:function(){var a=y.body.data("ng-dialog-original-padding");a?y.body.css("padding-right",a+"px"):y.body.css("padding-right","")},performCloseDialog:function(a,b){var c=a.find(".nicescroll-rails");c.remove();var f=a.data("$qcDialogOptions"),g=a.attr("id"),h=i[g];if(h){if("undefined"!=typeof v.Hammer){var l=h.hammerTime;l.off("tap",m),l.destroy&&l.destroy(),delete h.hammerTime}else a.unbind("click");1===o&&y.body.unbind("keydown",z.onDocumentKeydown),a.hasClass("qc-dialog-closing")||(o-=1);var n=a.data("$qcDialogPreviousFocus");n&&n.focus(),t.$broadcast("qc-dialog.closing",a,b),o=0>o?0:o,d&&!f.disableAnimation?(h.$destroy(),a.unbind(e).bind(e,function(){z.closeDialogElement(a,b)}).addClass("qc-dialog-closing")):(h.$destroy(),z.closeDialogElement(a,b)),p[g]&&(p[g].resolve({id:g,value:b,$dialog:a,remainiqcDialogs:o}),delete p[g]),i[g]&&delete i[g],j.splice(j.indexOf(g),1),j.length||(y.body.unbind("keydown",z.onDocumentKeydown),k=!1)}},closeDialogElement:function(a,b){a.remove(),0===o&&(y.html.removeClass("qc-dialog-open"),y.body.removeClass("qc-dialog-open"),z.resetBodyPadding()),t.$broadcast("qc-dialog.closed",a,b)},closeDialog:function(a,b){var c=a.data("$qcDialogPreCloseCallback");if(c&&angular.isFunction(c)){var d=c.call(a,b);angular.isObject(d)?d.closePromise?d.closePromise.then(function(){z.performCloseDialog(a,b)}):d.then(function(){z.performCloseDialog(a,b)},function(){}):d!==!1&&z.performCloseDialog(a,b)}else z.performCloseDialog(a,b)},onTrapFocusKeydown:function(a){var b,c=angular.element(a.currentTarget);if(c.hasClass("qc-dialog"))b=c;else if(b=z.getActiveDialog(),null===b)return;var d=9===a.keyCode,e=a.shiftKey===!0;d&&z.handleTab(b,a,e)},handleTab:function(a,b,c){var d=z.getFocusableElements(a);if(0===d.length)return void(document.activeElement&&document.activeElement.blur());var e=document.activeElement,f=Array.prototype.indexOf.call(d,e),g=-1===f,h=0===f,i=f===d.length-1,j=!1;c?(g||h)&&(d[d.length-1].focus(),j=!0):(g||i)&&(d[0].focus(),j=!0),j&&(b.preventDefault(),b.stopPropagation())},autoFocus:function(b){var c=b[0],d=c.querySelector("*[autofocus]");if(null===d||(d.focus(),document.activeElement!==d)){var e=z.getFocusableElements(b);if(e.length>0)return void e[0].focus();var f=z.filterVisibleElements(c.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(f.length>0){var g=f[0];a(g).attr("tabindex","-1").css("outline","0"),g.focus()}}},getFocusableElements:function(a){var b=(a[0],a.find(f)),c=z.filterTabbableElements(b);return z.filterVisibleElements(c)},filterTabbableElements:function(b){for(var c=[],d=0;d<b.length;d++){var e=b[d];"-1"!==a(e).attr("tabindex")&&c.push(e)}return c},filterVisibleElements:function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c];(d.offsetWidth>0||d.offsetHeight>0)&&b.push(d)}return b},getActiveDialog:function(){var b=document.querySelectorAll(".qc-dialog");return 0===b.length?null:a(b[b.length-1])},applyAriaAttributes:function(a,b){if(b.ariaAuto){if(!b.ariaRole){var c=z.getFocusableElements(a).length>0?"dialog":"alertdialog";b.ariaRole=c}b.ariaLabelledBySelector||(b.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),b.ariaDescribedBySelector||(b.ariaDescribedBySelector="article,section,p")}b.ariaRole&&a.attr("role",b.ariaRole),z.applyAriaAttribute(a,"aria-labelledby",b.ariaLabelledById,b.ariaLabelledBySelector),z.applyAriaAttribute(a,"aria-describedby",b.ariaDescribedById,b.ariaDescribedBySelector)},applyAriaAttribute:function(b,c,d,e){if(d&&b.attr(c,d),e){var f=b.attr("id"),g=b[0].querySelector(e);if(!g)return;var h=f+"-"+c;return a(g).attr("id",h),b.attr(c,h),h}},detectUIRouter:function(){try{return angular.module("ui.router"),!0}catch(a){return!1}},getRouterLocationEventName:function(){return z.detectUIRouter()?"$stateChangeSuccess":"$locationChangeSuccess"},getMessageTemplate:function(a,b){var c='<div class="dialog-body-md-del">   <span><em class="fa fa-exclamation-triangle"></em><i></i>'+a+'</span></div><div class="qc-dialog-footer">   <div class="text-center">';return"confirm"===b&&(c+='<button class="butn butn-default " ng-click="confirm()">确认</button>'),c+='<button class="butn butn-primary " ng-click="closeThisDialog(this)">关闭</button>   </div></div><div class="qc-dialog-close-base" ng-click="closeThisDialog(this)"></div>'}},A={open:function(b){function d(a,b){return t.$broadcast("qcDialog.templateLoading",a),s.get(a,b||{}).then(function(b){return t.$broadcast("qcDialog.templateLoaded",a),b.data||""})}function e(a){return a?angular.isString(a)&&f.plain?a:"boolean"!=typeof f.cache||f.cache?d(a,{cache:c}):d(a,{cache:!1}):"Empty template"}var f=angular.copy(l),h=++n,B="qcDialog"+h;j.push(B),b=b||{},angular.extend(f,b);var C;p[B]=C=r.defer();var D;i[B]=D=angular.isObject(f.scope)?f.scope.$new():t.$new(),f.title&&(D.title=f.title);var E,F,G=angular.extend({},f.resolve);return angular.forEach(G,function(a,b){G[b]=angular.isString(a)?x.get(a):x.invoke(a,null,null,b)}),r.all({template:e(f.template||f.templateUrl),locals:r.all(G)}).then(function(b){var c=b.template,d=b.locals;if(f.title&&(c='<div class="qc-dialog-header"> <div class="qc-dialog-title" ng-bind="title"></div> </div>'+c),f.showClose&&(c+='<div class="qc-dialog-close"></div>'),E=a('<div id="qcDialog'+h+'" class="qc-dialog"></div>'),E.html(f.overlay?'<div class="qc-dialog-overlay"></div><div class="qc-dialog-content" role="document">'+c+"</div>":'<div class="qc-dialog-content" role="document">'+c+"</div>"),f.width&&angular.element(".qc-dialog-content",E).css({width:f.width}),f.draggable&&(angular.element(".qc-dialog-content",E).attr("data-drag",!0),angular.element(".qc-dialog-content",E).attr("qc-draggable",""),angular.element(".qc-dialog-content",E).attr("data-qc-options",'{cancel:".qc-dialog-header~"}')),E.data("$qcDialogOptions",f),D.qcDialogId=B,f.data&&angular.isString(f.data)){var e=f.data.replace(/^\s*/,"")[0];D.qcDialogData="{"===e||"["===e?angular.fromJson(f.data):f.data,D.qcDialogData.qcDialogId=B}else f.data&&angular.isObject(f.data)&&(D.qcDialogData=f.data,D.qcDialogData.qcDialogId=B);if(f.controller&&(angular.isString(f.controller)||angular.isArray(f.controller)||angular.isFunction(f.controller))){var i;f.controllerAs&&angular.isString(f.controllerAs)&&(i=f.controllerAs);var j=w(f.controller,angular.extend(d,{$scope:D,$element:E}),null,i);E.data("$qcDialogControllerController",j)}if(f.className&&E.addClass(f.className),f.disableAnimation&&E.addClass(g),F=f.appendTo&&angular.isString(f.appendTo)?angular.element(document.querySelector(f.appendTo)):y.body,z.applyAriaAttributes(E,f),f.preCloseCallback){var l;angular.isFunction(f.preCloseCallback)?l=f.preCloseCallback:angular.isString(f.preCloseCallback)&&D&&(angular.isFunction(D[f.preCloseCallback])?l=D[f.preCloseCallback]:D.$parent&&angular.isFunction(D.$parent[f.preCloseCallback])?l=D.$parent[f.preCloseCallback]:t&&angular.isFunction(t[f.preCloseCallback])&&(l=t[f.preCloseCallback])),l&&E.data("$qcDialogPreCloseCallback",l)}if(D.closeThisDialog=function(a){z.closeDialog(E,a)},u(function(){var a=document.querySelectorAll(".qc-dialog");z.deactivateAll(a),q(E)(D);var b=v.innerWidth-y.body.prop("clientWidth");y.html.addClass("qc-dialog-open"),y.body.addClass("qc-dialog-open");var c=b-(v.innerWidth-y.body.prop("clientWidth"));c>0&&z.setBodyPadding(c),F.append(E),z.activate(E),f.trapFocus&&z.autoFocus(E),f.name?t.$broadcast("qc-dialog.opened",{dialog:E,name:f.name}):t.$broadcast("qc-dialog.opened",E)}),k||(y.body.bind("keydown",z.onDocumentKeydown),k=!0),f.closeByNavigation){var n=z.getRouterLocationEventName();t.$on(n,function(){z.closeDialog(E)})}if(f.preserveFocus&&E.data("$qcDialogPreviousFocus",document.activeElement),m=function(b){var c=f.closeByDocument?a(b.target).hasClass("qc-dialog-overlay"):!1,d=a(b.target).hasClass("qc-dialog-close");(c||d)&&A.close(E.attr("id"),d?"$closeButton":"$document")},"undefined"!=typeof v.Hammer){var p=D.hammerTime=v.Hammer(E[0]);p.on("tap",m)}else E.bind("click",m);return o+=1,A}),{id:B,closePromise:C.promise,close:function(a){z.closeDialog(E,a)}}},openConfirm:function(b){var c=r.defer(),d={closeByEscape:!1,closeByDocument:!1};angular.extend(d,b),d.scope=angular.isObject(d.scope)?d.scope.$new():t.$new(),d.scope.confirm=function(b){c.resolve(b);var d=a(document.getElementById(e.id));z.performCloseDialog(d,b)};var e=A.open(d);return e.closePromise.then(function(a){return a?c.reject(a.value):c.reject()}),c.promise},openMessage:function(b){var c=r.defer(),d={closeByEscape:!1,closeByDocument:!1,plain:!0,showClose:!1,template:z.getMessageTemplate(b.msg,b.type)};angular.extend(d,b),d.scope=angular.isObject(d.scope)?d.scope.$new():t.$new(),d.scope.confirm=function(b){c.resolve(b);var d=a(document.getElementById(e.id));z.performCloseDialog(d,b)};var e=A.open(d);return e.closePromise.then(function(a){return a?c.reject(a.value):c.reject()}),c.promise},openCover:function(a){var b={className:"qc-dialog-theme-cover",draggable:!1,closeByEscape:!1,closeByDocument:!1};angular.extend(b,a);var c=A.open(b);return c},isOpen:function(b){var c=a(document.getElementById(b));return c.length>0},close:function(b,c){var d=a(document.getElementById(b));if(d.length)z.closeDialog(d,c);else if("$escape"===b){var e=j[j.length-1];d=a(document.getElementById(e)),d.data("$qcDialogOptions").closeByEscape&&z.closeDialog(d,c)}else A.closeAll(c);return A},closeAll:function(b){for(var c=document.querySelectorAll(".qc-dialog"),d=c.length-1;d>=0;d--){var e=c[d];z.closeDialog(a(e),b)}},getOpenDialogs:function(){return j},getDefaults:function(){return l}};return A}]}),qc.service("qcFlashVersion",["$window",function(a){var b,c;if(a.document.all){var d;try{d=new a.ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}if(d){b=!0;var f=d.GetVariable("$version");c=f.split(" ")[1],c=c.substring(0,c.indexOf(","))}}else for(var g=0;g<a.navigator.plugins.length;g++)a.navigator.plugins[g].name.toLowerCase().indexOf("shockwave flash")>=0&&(b=!0,c=a.navigator.plugins[g].description.substring(a.navigator.plugins[g].description.toLowerCase().lastIndexOf("flash ")+6,a.navigator.plugins[g].description.length),c=c.substring(0,c.indexOf(".")));this.installed=b,this.version=c}]),qc.config(["$httpProvider",function(a){var b=["qcMessage","$q","urlConfig",function(a,b,c){return{request:function(a){return a},response:function(d){return d.data&&"mtour data"===d.data.responseType?"success"===d.data.responseCode?d:"fail"===d.data.responseCode?(a.warning(d.data.msg.code+":"+d.data.msg.description),b.reject(d)):"authentication"===d.data.responseCode?(a.warning("您还没有登录,请重新登录!").then(function(){window.location=c.mtourLoginUrl}),b.reject(d)):"error"===d.data.responseCode?(a.error("服务器发生异常,请联系管理员"),b.reject(d)):void a.error("未定义的返回代码:"+d.data.responseCode):d},responseError:function(c){return"mtour data"===c.responseType?b.reject(c):(a.error("发生未知异常,请联系管理员"),b.reject(c))}}}];a.interceptors.push(b)}]),qc.provider("qcLoadingBar",function(){this.autoIncrement=!0,this.includeSpinner=!0,this.includeBar=!1,this.latencyThreshold=100,this.startSize=.02,this.parentSelector="body",this.spinnerTemplate='<div id="qc-loading-bar-spinner"><div class="spinner-icon"></div></div>',this.loadingBarTemplate='<div id="qc-loading-bar"><div class="bar"><div class="peg"></div></div></div>',this.$get=["$injector","$document","$timeout","$rootScope",function(a,b,c,d){function e(){k||(k=a.get("$animate"));var e=b.find(n).eq(0);c.cancel(m),r||(d.$broadcast("qcLoadingBar:started"),r=!0,v&&k.enter(o,e,angular.element(e[0].lastChild)),u&&k.enter(q,e,angular.element(e[0].lastChild)),f(w))}function f(a){if(r){var b=100*a+"%";p.css("width",b),s=a,t&&(c.cancel(l),l=c(function(){g()},250))}}function g(){if(!(h()>=1)){var a=0,b=h();a=b>=0&&.25>b?(3*Math.random()+3)/100:b>=.25&&.65>b?3*Math.random()/100:b>=.65&&.9>b?2*Math.random()/100:b>=.9&&.99>b?.005:0;var c=h()+a;f(c)}}function h(){return s}function i(){s=0,r=!1}function j(){k||(k=a.get("$animate")),d.$broadcast("qcLoadingBar:completed"),f(1),c.cancel(m),m=c(function(){var a=k.leave(o,i);a&&a.then&&a.then(i),k.leave(q)},500)}var k,l,m,n=this.parentSelector,o=angular.element(this.loadingBarTemplate),p=o.find("div").eq(0),q=angular.element(this.spinnerTemplate),r=!1,s=0,t=this.autoIncrement,u=this.includeSpinner,v=this.includeBar,w=this.startSize;return{start:e,set:f,status:h,inc:g,complete:j,autoIncrement:this.autoIncrement,includeSpinner:this.includeSpinner,latencyThreshold:this.latencyThreshold,parentSelector:this.parentSelector,startSize:this.startSize}}]}),qc.config(["$httpProvider",function(a){var b=["$q","$cacheFactory","$timeout","$rootScope","$log","qcLoadingBar",function(b,c,d,e,f,g){function h(){d.cancel(j),g.complete(),l=0,k=0}function i(b){var d,e=c.get("$http"),f=a.defaults;!b.cache&&!f.cache||b.cache===!1||"GET"!==b.method&&"JSONP"!==b.method||(d=angular.isObject(b.cache)?b.cache:angular.isObject(f.cache)?f.cache:e);var g=void 0!==d?void 0!==d.get(b.url):!1;return void 0!==b.cached&&g!==b.cached?b.cached:(b.cached=g,g)}var j,k=0,l=0,m=g.latencyThreshold;return{request:function(a){return a.ignoreLoadingBar||i(a)||(e.$broadcast("qcLoadingBar:loading",{url:a.url}),0===k&&(j=d(function(){g.start()},m)),k++,g.set(l/k)),a},response:function(a){return a&&a.config?(a.config.ignoreLoadingBar||i(a.config)||(l++,e.$broadcast("qcLoadingBar:loaded",{url:a.config.url,result:a}),l>=k?h():g.set(l/k)),a):(f.error("Broken interceptor detected: Config object not supplied in response:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),a)},responseError:function(a){return a&&a.config?(a.config.ignoreLoadingBar||i(a.config)||(l++,e.$broadcast("qcLoadingBar:loaded",{url:a.config.url,result:a}),l>=k?h():g.set(l/k)),b.reject(a)):(f.error("Broken interceptor detected: Config object not supplied in rejection:\n https://github.com/chieffancypants/angular-loading-bar/pull/50"),b.reject(a))}}}];a.interceptors.push(b)}]),qc.provider("qcMessage",function(){var a={infoShowTime:2,tipShowTime:5};this.$get=["$timeout","$q",function(b,c){var d=angular.isDefined,e=(document.body||document.documentElement).style,f=d(e.animation)||d(e.WebkitAnimation)||d(e.MozAnimation)||d(e.MsAnimation)||d(e.OAnimation),g="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",h='<div class="qc-message-container"></div>',i='<div class="qc-message-overlay"></div>',j='<div class="qc-message-content">    <div class="qc-message-header">        <div class="qc-message-title"></div>    </div>    <div class="qc-message-body">    </div>    <div class="qc-message-footer">    </div></div>',k=function(a){var b=c.defer(),d=angular.element(h);angular.element(document.body).append(d),d.addClass("warning");var e=angular.element(j);angular.element(".qc-message-title",e).html("!!!Warning"),angular.element(".qc-message-body",e).html(a);var f=angular.element('<button class="qc-message-button-close btn btn-default">关闭</button>');return angular.element(".qc-message-footer",e).append(f),f.on("click",function(){return p(angular.element(".qc-message-content",d),d),p(angular.element(".qc-message-overlay",d)),b.resolve("close")}),d.append(i),d.append(e),b.promise},l=function(a){var b=c.defer(),d=angular.element(h);angular.element(document.body).append(d),d.addClass("error");var e=angular.element(j);angular.element(".qc-message-title",e).html("*&@Error"),angular.element(".qc-message-body",e).html(a);var f=angular.element('<button class="qc-message-button-close btn btn-default">关闭</button>');return angular.element(".qc-message-footer",e).append(f),f.on("click",function(){return p(angular.element(".qc-message-content",d),d),p(angular.element(".qc-message-overlay",d)),b.resolve("close")}),d.append(i),d.append(e),b.promise},m=function(a){var b=c.defer(),d=angular.element(h);angular.element(document.body).append(d),d.addClass("confirm");var e=angular.element(j);angular.element(".qc-message-title",e).html("???Confirm"),angular.element(".qc-message-body",e).html(a);var f=angular.element('<button class="qc-message-button-confirm btn btn-primary">确认</button>'),g=angular.element('<button class="qc-message-button-cancel btn btn-default">取消</button>');return angular.element(".qc-message-footer",e).append(f),angular.element(".qc-message-footer",e).append("<span> </span>"),angular.element(".qc-message-footer",e).append(g),f.on("click",function(){p(angular.element(".qc-message-content",d),d),p(angular.element(".qc-message-overlay",d)),b.resolve("confirm")}),g.on("click",function(){p(angular.element(".qc-message-content",d),d),p(angular.element(".qc-message-overlay",d)),b.reject("cancel")}),d.append(i),d.append(e),b.promise},n=function(c){var d=angular.element(document.querySelector(".qc-message-container.tip"));d.length||(d=angular.element('<div class="qc-message-container tip"></div>'),angular.element(document.body).append(d));var e=angular.element('<div class="qc-message-content">'+c+"</div>");d.prepend(e),b(function(){p(e)},1e3*a.tipShowTime)},o=function(c){var d=angular.element(document.querySelector(".qc-message-container.info"));d.length||(d=angular.element('<div class="qc-message-container info"></div>'),angular.element(document.body).append(d));var e=angular.element('<div class="qc-message-content">'+c+"</div>");d.prepend(e),b(function(){p(e)},1e3*a.infoShowTime)},p=function(a,b){b||(b=a),f?(a.addClass("closing"),a.on(g,function(){b.remove()})):b.remove()};return{warning:k,error:l,confirm:m,info:o,tip:n}}]}),qc.factory("qcObjectInArray",function(){return function(a,b,c){if(!angular.isArray(a))return void 0;for(var d,e=a.length,f=0;e>f;){if(a[f][b]==c){d=a[f];break}f++}return d}});
/*! M-tour 最后修改于： 2015-11-27 */